## ðŸ§€ Challenge: **Registry Malware Hunt**

**Difficulty:** Medium  
**Category:** Forensics  

---

### ðŸ“œ Story:
In a routine security audit for Manager Mart, you are tasked with analyzing their system registry hives for signs of malware infection. The IT team has provided you with four sets of registry hives, each captured at different points in time, along with a baseline hive from a clean state. Your mission is to identify the artifacts that reveal the presence of malware in each infected hive set.
[file](https://mega.nz/file/TAh3wCZB#2rbF0MgSonjc_b5jpnbG0oyfrucIATyQ9bIpo88zM88)
Flag: AzCTF{theUnregisterdDlls_LastWriteDate}

##### Hints: 
```
You would then run your plugin by passing -p virusdomain to RegRipper.
```
---

### ðŸ“‹ Manual Walkthrough (RegRipper & Diff Analysis):

### Analyzing Unregistered DLLs and LastWriteDate

To determine the **Unregistered DLLs** and their **LastWriteDate**, we will follow a structured approach using the provided information. Here's a step-by-step analysis:

#### **Step 1: Understanding the Context**
The analysis involves comparing the output of the `appcertdlls` plugin from **RegRipper** against two different SYSTEM hives:
1. **Baseline SYSTEM Hive**: Represents a clean state without any infections.
2. **Infected SYSTEM Hive (Set 1)**: Represents the state after potential malware infection.

#### **Step 2: Identifying Unregistered DLLs**
- **Baseline SYSTEM Hive Output:**
  ```
  ControlSet001\Control\Session Manager\AppCertDlls not found.
  ```
  This indicates that there are **no AppCertDlls registered** in the baseline system.

- **Infected SYSTEM Hive (Set 1) Output:**
  ```
  ControlSet001\Control\Session Manager\AppCertDlls
  LastWrite Time: 2017-11-22 22:46:58Z
  fltMsfc - C:\WINDOWS\system32\cidaec32.dll
  ```
  This shows that an AppCertDll, `cidaec32.dll`, is registered in the infected system.

- **Unregistered DLLs:**
  Since the baseline has no AppCertDlls registered, any DLLs present in the infected system are considered **unregistered**. In this case, the unregistered DLL is:
  ```
  cidaec32.dll
  ```

#### **Step 3: Determining the LastWriteDate**
- The **LastWriteTime** for the `AppCertDlls` key in the infected SYSTEM hive is:
  ```
  2017-11-22 22:46:58Z
  ```
  This timestamp indicates when the `AppCertDlls` key was last modified, which corresponds to the time when the unregistered DLL (`cidaec32.dll`) was added.

#### **Step 4: Interpreting the Findings**
- The presence of an unregistered DLL (`cidaec32.dll`) in the infected SYSTEM hive suggests that this DLL was likely introduced by malware.
- The **LastWriteDate** provides a timeline of when the malware modified the system registry to include this DLL.

#### **Step 5: Additional Analysis (Optional)**
For a more comprehensive analysis, you can:
- **Investigate the DLL**: Analyze `cidaec32.dll` to determine its origin and purpose.
- **Check for Persistence Mechanisms**: Look for other registry keys or files that might indicate how the malware maintains persistence.
- **Compare with Other Hives**: Analyze other hives (e.g., SOFTWARE) to identify any related changes.

---

### ðŸŽ¯ Flag Format:
```
AzCTF{cidaec32.dll_Wed Nov 22 22:30:47 2017}
```